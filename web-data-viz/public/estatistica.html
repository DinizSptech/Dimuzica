<!DOCTYPE html>
<script src="./main.js"></script>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dimuzica</title>
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="./assets/logo.ico" type="image/x-icon">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>     
</head>
<body class="home" onload="mostrarGrafico()">
  <div class="header">
    <div class="inicio_header">
      <div class="header_button" onclick="local_estatistica()">
        <img src="./assets/stats.png"  alt="estatisticas">
        <div>Estatisticas</div>
      </div>
      <div  class="header_button" onclick="local_sobremim()">
        <img src="./assets/vinil.png" alt="vinil"> 
        <div>Sobre mim</div>
      </div>
      <div class="header_button" onclick="local_index()">
        <img src="./assets/home.png"  alt="estatisticas"> 
        <div>In√≠cio</div>
      </div>
    </div>
    <div class="linha"></div>
      <div class="botaolegal">
        <div class="login_button" onclick="local_login()">Login</div>
        <div class="cadastro_button" onclick="local_cadastro()">Cadastro</div>
      </div>
    </div></style>
    <body>
        <div class="dashboards">
            <div>
                <canvas id="grafico" style="height: 80vh; width: 40vw;"></canvas>
            </div>
        </div>
    
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
      <script>
        var listaGenero = [];
        var listaNumero = [];
        var generoAtual = '';
        var numeroAtual = '';
          
        function mostrarGrafico() {
          fetch("/grafico/grafico-dados", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            }
          }).then(function (resposta) {
                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));
                    
                    for(var cont = 0; cont < (json.lista).length; cont++) {
                      generoAtual = json.lista[cont].genero;
                      numeroAtual = json.lista[cont].qtd;               

                      listaGenero.push(generoAtual);
                      listaNumero.push(numeroAtual);

                    }
    
                  const ctx = document.getElementById("grafico");
                  
                  new Chart(ctx, {
                    type: "pie",
                    data: {
                      labels: listaGenero,
                      datasets: [{
                          data: listaNumero,
                          backgroundColor: ['rgb(250, 67, 198)', 'rgb(171, 24, 19)', 'rgb(255, 132, 0)'],
                          borderColor:['rgb(0,0,0)'],
                          borderWidth: 3,
                        }
                      ],
                    },
                      
                    
                  });
                })
              })
            }
      </script>
    </body>
    